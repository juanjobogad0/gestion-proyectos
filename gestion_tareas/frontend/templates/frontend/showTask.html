{% extends 'frontend/navegacion.html' %}
{% block contenido %}

<h2 class="mt-3 text-center">Tareas</h2>

<div class="container">
  <!-- mensaje -->
{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show w-75 mx-auto" role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
    </div>
  {% endfor %}
{% endif %}

  <div class="table-responsive">
    <table class="table table-striped align-middle text-center">
      <thead>
        <tr>
          <th>ID</th>
          <th>Título</th>
          <th>Descripción</th>
          <th>Estado</th>
          <th>Prioridad</th>
          <th>Asignado a</th>
          <th>Fecha límite</th>
          <th>Creado</th>
          <th>Actualizado</th>
          <th>Proyecto ID</th>
          <th>Accion</th>
        </tr>
      </thead>
      <tbody>
        {% for tarea in tareas %}
          <tr>
            <td>{{ tarea.id }}</td>
            <td>{{ tarea.title }}</td>
            <td>
              {% if tarea.description %}
                {{ tarea.description }}
              {% else %}
                 <span class="text-muted">None</span>
              {% endif %}
            </td>
            <td>{{ tarea.status }}</td>
            <td>{{ tarea.priority }}</td>
            <td>
              {% if tarea.assigned_to %}
                {{ tarea.assigned_to }}
              {% else %}
                <span class="text-muted">Sin asignar</span>
              {% endif %}
            </td>
            <td>
              {% if tarea.due_date %}
                {{ tarea.due_date }}
              {% else %}
                <span class="text-muted">Sin fecha</span>
              {% endif %}
            </td>
            <td>{{ tarea.created_at }}</td>
            <td>{{ tarea.updated_at }}</td>
            <td>{{ tarea.project }}</td>
            <td>
              <form action="{% url 'frontend_editTask' pk=tarea.project id=tarea.id %}" method="get" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-warning">
                  Editar
                </button>
              </form>
              <form action="{% url 'frontend_deleteTask' pk=tarea.project id=tarea.id %}" method="post" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger" onclick="return confirm('Seguro que quieres elminar esta tarea?');">
                 Eliminar
                </button>
              </form>
            </td>
            
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>


{% endblock %}
